/* ===== Brassreach Skin v13 ===== */
:root{
  --bg:#0c0f12; --bg2:#14181d; --ink:#e6d9a2; --ink2:#f1e6bb;
  --gold:#d5a84a; --gold2:#9a6b24; --crimson:#7b2a2a; --emerald:#3a6f5b;
  --line:#6f5320; --line2:#caa45a; --accent:#e0c98a; --muted:#c8bb87;
  --white:#f5f2e6; --bronze:#b37b3a;
}
/* Global cursor */
html, body, .app, #intro {
  cursor: url("../img/cursor-spear.png") 3 2, auto;
}

/* Interactive hover keeps the spear (no glow) */
a:hover,
button:hover,
.btn:hover,
[role="button"]:hover,
[onclick]:hover,
.gloss,
.gloss:hover {
  cursor: url("../img/cursor-spear.png") 3 2, pointer;
}

/* Edit fields keep the I-beam */
input[type="text"], input[type="search"], input[type="email"],
input[type="password"], textarea, [contenteditable="true"] { cursor: text; }

/* Visibility toggles */
.hidden { display: none !important; }
.modal:not(.hidden) { display: block; }
.shade:not(.hidden) { display: block; }
#intro.hidden { display: none !important; }


/* Base */
html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:"Josefin Sans", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif;}
*{box-sizing:border-box}

/* Boot */
.boot{position:fixed;inset:0;display:grid;place-items:center;background:linear-gradient(180deg,#0c0f12,#0a0d10)}
.boot .box{padding:14px 18px;border:1px solid #2e2a20;border-radius:8px;background:#11161c;color:#e0d6b2}
.boot.ok{display:none}

/* Crest watermark (main app) */
.crest{
  position:fixed; inset:0; pointer-events:none;
  z-index:1;                /* above page bg, below UI/intro */
  opacity:.12;              /* bump for visibility; dial back later */
  background:
    /* SVG FIRST so it paints on top */
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1200" viewBox="0 0 1200 1200"><g fill="none" stroke="#715322" stroke-width="8" opacity="0.8"><circle cx="600" cy="580" r="320"/><path d="M280,580 L600,240 L920,580 L600,920 Z"/><path d="M430,580 L600,400 L770,580 L600,760 Z"/><path d="M600,260 L600,900"/><path d="M260,580 L940,580"/></g></svg>') center/60vmin 60vmin no-repeat,
    radial-gradient(1200px 800px at 20% 8%, #121921 0%, #0c0f12 55%);
  animation: crestDrift 10s ease-in-out infinite alternate,
             crestGlow 10s ease-in-out infinite;
}

/* DEBUG ONLY: lift crest above all UI to verify it's drawing */
.crest--ontop {
  z-index: 2147483000;   /* above any overlay */
  opacity: .22;
  pointer-events: none;
}

/* Crest watermark + parallax container */
.app{position:relative;min-height:100vh}


/* Crest behind the intro overlay */
#intro::before{
  content:"";
  position: fixed; inset: 0; pointer-events: none; z-index: 0;
  opacity: .14;
  background:
    /* SVG FIRST again */
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1200" viewBox="0 0 1200 1200"><g fill="none" stroke="#715322" stroke-width="8" opacity="0.8"><circle cx="600" cy="580" r="320"/><path d="M280,580 L600,240 L920,580 L600,920 Z"/><path d="M430,580 L600,400 L770,580 L600,760 Z"/><path d="M600,260 L600,900"/><path d="M260,580 L940,580"/></g></svg>') center/60vmin 60vmin no-repeat,
    radial-gradient(1200px 800px at 20% 8%, rgba(18,25,33,.85) 0%, rgba(12,15,18,.85) 55%);
}

/* Subtle bronze/gold glow rising from the bottom during intro */
#intro::after{
  content:"";
  position: fixed; left:0; right:0; bottom:0; height: 20vh;
  pointer-events: none; z-index: 1; /* below text, above crest layer */
  background:
    radial-gradient(120% 80% at 50% 100%,
      rgba(213,168,74,.22), rgba(213,168,74,0) 60%);
  animation: emberPulse 10s ease-in-out infinite;
  filter: saturate(1.4);
}
@keyframes emberPulse{
  0%,100% { opacity:.55; }
  50%     { opacity:.95; }
}

/* FX containers (defensive; JS also inlines) */
#fx, #fxIntro { position: fixed; inset: 0; pointer-events: none; z-index: 1; }

/* Intro cutout baseline (safe defaults; tweak sizes later) */
#intro .slide{ position: relative; }
#intro .slide .pic{
  position: absolute;
  left: 6vw; top: 12vh; width: 34vw; height: 52vh;
  pointer-events: none; z-index: 2;
}
/* --- Intro cutout: image behind black veil, revealed by jagged PNG mask --- */
#intro .slide { position: relative; }
#intro .slide .pic{
  position: absolute;
  left: 6vw; top: 12vh; width: 34vw; height: 52vh;
  pointer-events: none; z-index: 2;
}

/* Image sits UNDER the veil; global sizing for now */
#intro .slide .pic .img{
  position: absolute; inset: 0; z-index: 1;
  background-size: cover; background-position: center center;
  transform: translate3d(0,0,0) scale(1.06);
  animation: introParallax 24s ease-in-out infinite;
}

/* Foreground veil = the “paper” layer.
   Mask is white outside (keep veil), black inside (cut hole to reveal image). */
#intro .slide .pic .veil{
  position: absolute; inset: 0; z-index: 2;
  background: #0a0f14; /* same as intro bg */
  -webkit-mask-image: url("./public/img/tear-mask.png");
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  -webkit-mask-size: contain;
  mask-image: url("./public/img/tear-mask.png");
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: contain;
  /* warm inner rim via drop-shadows that hug the hole’s alpha edge */
  filter:
    drop-shadow(0 0 10px rgba(213,168,74,.25))
    drop-shadow(0 0 22px rgba(213,168,74,.12));
}
#intro .slide .pic .veil::after{
  /* subtle fibers/noise that sit only where the veil exists */
  content:""; position:absolute; inset:0; pointer-events:none;
  background: url("./public/img/paper-noise.png") repeat;
  opacity:.18; mix-blend-mode: overlay;
  -webkit-mask-image: url("./public/img/tear-mask.png");
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  -webkit-mask-size: contain;
  mask-image: url("./public/img/tear-mask.png");
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: contain;
}

/* Tiny breathing motion to sell depth (paired with JS restart on slide change) */
@keyframes introParallax{
  0%   { transform: translate3d( 0px,  0px,0) scale(1.06); }
  50%  { transform: translate3d( 4px, -3px,0) scale(1.06); }
  100% { transform: translate3d( 0px,  0px,0) scale(1.06); }
}

/* Optional: zoom for first-view entrance if you want it */
@keyframes introZoom{
  0%   { transform: translate3d(0,0,0) scale(1.01); filter:saturate(1.02) brightness(1.01); }
  100% { transform: translate3d(0,0,0) scale(1.06); filter:saturate(1.08) brightness(1.02); }
}


/* Main screen bronze/gold bottom glow (mirrors #intro::after) */
#glow{
  position: fixed; left:0; right:0; bottom:0; height: 20vh;
  pointer-events: none; z-index: 1; /* below text, above crest; embers (#fx) are later in DOM */
  background:
    radial-gradient(120% 80% at 50% 100%,
      rgba(213,168,74,.22), rgba(213,168,74,0) 60%);
  animation: emberPulse 10s ease-in-out infinite;
  filter: saturate(1.4);
}

/* Masthead */
.masthead{position:relative;padding:22px 18px 12px;border-bottom:2px solid var(--line);}

/* Split title: BRASS (gold) | REACH (bronze) */
.brand-title .title-left,
.intro-title .title-left {
  color: var(--gold);
  letter-spacing: 0.12em;
  display: inline-block;
  transform: translateX(1.5rem); /* move BRASS toward the seam */
}
.brand-title .title-right,
.intro-title .title-right{
  color: var(--bronze);
  letter-spacing: 0.12em;
  display:inline-block;
  transform: translateX(-.3rem); /* mirror inward */
}
.brand-title .title-gap,
.intro-title .title-gap{ display:inline-block; width: 3.6rem; }

/* === Brassreach double-underline utility === */
.u-double-underline {
  position: relative;
  padding-bottom: 10px;
}
.u-double-underline::after,
.u-double-underline::before {
  content: "";
  position: absolute; left: 50%; transform: translateX(-50%);
  width: clamp(240px, 48vw, 680px);
  border-radius: 2px;
  height: 0;
  pointer-events: none;
}
.u-double-underline::after { /* primary, thicker */
  bottom: 0;
  border-bottom: 4px solid transparent;
  background: linear-gradient(90deg, #d5a84a, #c7872f 60%, #9a6b24);
  -webkit-mask: linear-gradient(#000, #000) content-box, linear-gradient(#000,#000);
  -webkit-mask-composite: xor; mask-composite: exclude;
  box-shadow:
    0 0 10px rgba(213,168,74,.55),
    0 0 24px rgba(213,168,74,.25);
}
.u-double-underline::before { /* echo, finer */
  bottom: 6px;
  border-bottom: 2px solid transparent;
  background: linear-gradient(90deg, #e6c57a, #d5a84a 60%, #9a6b24);
  box-shadow:
    0 0 6px rgba(213,168,74,.45),
    0 0 16px rgba(213,168,74,.18);
}

/* High-contrast mode: preserve WCAG while keeping the aura */
.hc .u-double-underline::after,
.hc .u-double-underline::before { box-shadow: 0 0 0 transparent; }

/* Toolbar */
.toolbar{display:flex;justify-content:center;margin-top:10px}
.controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}

/* Buttons */
.btn{
  background:linear-gradient(180deg,#212833,#131921);
  color:var(--white); border:2px solid var(--line);
  padding:10px 12px; cursor:pointer; transition:transform .05s ease, filter .15s ease;
  position:relative; box-shadow:0 0 0 2px var(--line2) inset;
}
.btn.gold{background:linear-gradient(180deg,#4b3917,#2b2212);border-color:var(--gold2);box-shadow:0 0 0 2px var(--gold) inset}
.btn:hover{filter:brightness(1.05)}
.btn:active{transform:scale(0.985)}
.btn::after{ /* click pulse */
  content:""; position:absolute; inset:-2px; pointer-events:none; opacity:0; border:2px solid var(--gold);
  transition:opacity .18s ease;
}
.btn:active::after{opacity:.7}

/* Squared double-lined cards w/ chevrons */
.card{background:linear-gradient(180deg,var(--bg2),#0c0f12); position:relative; padding:12px; margin:10px; color:var(--ink);
  border:2px solid var(--line); box-shadow:0 0 0 2px var(--line2) inset;}
.card h3{margin:0 0 8px 0; text-align:center; font-weight:700; letter-spacing:.6px}
.card .inner{position:relative}
.card .corners::before, .card .corners::after{content:""; position:absolute; width:18px; height:18px; border-top:2px solid var(--line2); border-left:2px solid var(--line2); }
.card .corners::before{left:8px; top:8px; transform:rotate(45deg)}
.card .corners::after{right:8px; bottom:8px; transform:rotate(225deg)}

/* Layout */
.main{display:grid; grid-template-columns: 1fr 320px; gap:12px; padding:12px}
@media (max-width: 1080px){ .main{grid-template-columns:1fr} }

/* Story box */
.storywrap .cardish{}
.story-scroll{
  min-height:56vh; max-height:68vh; overflow:auto; padding:18px;
  background:linear-gradient(180deg,#0e141a 0%, #0a0f14 100%);
  border:2px solid var(--line); box-shadow:0 0 0 2px var(--line2) inset; position:relative;
}
.story-scroll p{ margin:12px 0; line-height:1.55; color:var(--ink2); position:relative; padding-left:26px }
.story-scroll p::before{ /* chevron bullet */
  content:"❯"; position:absolute; left:6px; top:2px; color:var(--gold); opacity:.9; text-shadow:0 0 6px rgba(213,168,74,.35);
}
.rollglyph{opacity:.8; margin-left:6px; cursor:help}

/* Choice area */
.choices{margin-top:10px; padding:10px; border:2px solid var(--line); box-shadow:0 0 0 2px var(--line2) inset; background:#10151a}
.choice-btn{display:block;width:100%;text-align:left;margin:6px 0;padding:12px;background:linear-gradient(180deg,#151b24,#0e1319);border:1px solid var(--gold2);color:var(--white);cursor:pointer}
.choice-btn:hover{filter:brightness(1.08)}

/* Free action row */
.free{display:flex;gap:8px;margin-top:8px}
.free input{flex:1;background:#0d141a;border:1px solid var(--gold2);padding:10px;border-radius:4px;color:var(--white)}
.free .btn.gold{font-weight:700}

/* Right column */
.side .card{ text-align:center }
#ledgerList{ display:flex; flex-wrap:wrap; gap:6px; justify-content:center }
.pill{border:1px solid var(--gold2);padding:4px 8px;border-radius:999px;background:#0b1117;font-size:.95rem}

/* Success / fail saturation behavior */
.glow-success{ color:var(--gold); filter:saturate(1.0); animation:fadeSat 4s forwards }
.glow-fail{ color:var(--crimson); filter:saturate(1.0); animation:fadeSat 4s forwards }
@keyframes fadeSat{ to{ filter:saturate(.33) } }
.glow-success:hover{ animation:none; filter:saturate(.5) drop-shadow(0 0 5px rgba(213,168,74,.6)) }
.glow-fail:hover{ animation:none; filter:saturate(.5) drop-shadow(0 0 5px rgba(123,42,42,.6)) }

/* Ephemeral Now Playing chip (visibility is JS-toggled) */
#nowplay{
  opacity:0;
  transition:opacity .35s ease;
  pointer-events:none;
}
#nowplay.show{ opacity:1; }

/* Typewriter reveal & smoke cursor */
.reveal .ch.on{opacity:1}
.reveal .cursor{
  display:inline-block; width:10px; height:1.2em;
  vertical-align:-.2em; position:relative; overflow:visible;
}

/* Centered puff that rises and fades */
.smoke{
  position:absolute;
  left:50%; bottom:0;
  transform: translate(-50%,0) scale(1);
  display:block;
  width:12px; height:12px; border-radius:50%;
  background:
    radial-gradient(circle at 50% 50%,
      rgba(255,235,180,.75),
      rgba(255,235,180,0) 70%);
  filter: drop-shadow(0 0 6px rgba(213,168,74,.35));
  animation: smoke .7s linear infinite;
  will-change: transform, opacity;
}

@keyframes smoke{
  0%   { transform: translate(-50%,0)      scale(1.00); opacity:.70; }
  100% { transform: translate(-50%,-12px)  scale(1.25); opacity:.05; }
}

/* Scroll icon (hidden until main app mounts) */
.scroll-btn{
  position:fixed; top:14px; right:14px; width:40px; height:40px; display:none;
  background:#1a212a; border:1px solid var(--gold2); box-shadow:0 0 0 2px var(--gold) inset; cursor:pointer;
}
.scroll-btn svg{width:100%;height:100%;filter:drop-shadow(0 0 6px rgba(213,168,74,.4))}
.scroll-btn:hover{filter:brightness(1.08)}

/* Modals */
.shade{position:fixed;inset:0;background:#0008;z-index:9998;display:none}
.modal{position:fixed;top:8%;left:50%;transform:translateX(-50%);width:min(720px,92vw);background:#0f141a;border:2px solid var(--line);box-shadow:0 0 0 2px var(--line2) inset;border-radius:0;padding:0;z-index:9999;display:none}
.modal header{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-bottom:2px solid var(--line)}
.modal .content{padding:14px; max-height:70vh; overflow:auto}
.closeX{cursor:pointer;border:1px solid var(--gold2);padding:4px 8px}

/* Character modal blue+gold inputs */
#modalEdit label > input,
#modalEdit .grid2 input,
#modalEdit select{
  background:#0d141a !important;  /* same deep blue as your backdrop */
  color:#D5A84A !important;        /* gold text */
  border:1px solid #8c6b2c !important;
  outline:1px solid rgba(213,168,74,.18);
}
#modalEdit input::placeholder{ color:rgba(213,168,74,.66) !important; }

/* Settings grid and sliders */
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.settings-row{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
input[type="range"]{width:100%}

/* Intro overlay title */
.intro-title{
  position: absolute; top: 14px; left: 50%; transform: translateX(-50%);
  z-index: 4;
  font-family:"Cinzel", serif; font-weight:700; letter-spacing:1.2px;
  font-size: clamp(1.8rem, 3.2vw, 2.3rem);
  color: var(--ink2);
  text-transform: uppercase;
  text-shadow:
    0 0 22px rgba(213,168,74,.35),
    0 0 6px rgba(213,168,74,.55),
    0 0 1px rgba(255,200,120,.9);
  filter: drop-shadow(0 0 24px rgba(255,140,40,.25));
}

/* Intro slides */
.intro{position:fixed;inset:0;background:#0a0f14;z-index:9000;display:flex;flex-direction:column}
.intro .pane{flex:1;display:grid;grid-template-columns:1fr 1fr;gap:0}
.intro .txt{position:relative;padding:30px 40px;overflow:hidden}
.intro .txt .inner{max-width:680px;margin:0 auto;font-size:1.05rem;line-height:1.6;color:var(--ink2);position:relative}
.intro .pic{position:relative;overflow:hidden}
.intro .pic .img{position:absolute;inset:-6%;background:radial-gradient(120% 100% at 50% 30%, #1a232b, #0a0f14 65%)}
.intro .nav{display:flex;justify-content:flex-end;gap:10px;padding:10px 20px;border-top:2px solid var(--line);background:#0d1218}
.intro .btn{min-width:120px}

/* Two-sided intro: image LEFT, text RIGHT */
.intro .pane { display:grid; grid-template-columns: 1fr 1fr; }
.intro .pic { grid-column: 1; }
.intro .txt { grid-column: 2; display:flex; align-items:center; }
.intro .txt .inner { margin: 0 auto; text-align: center; }

/* Intro nav buttons: text-only, no box */
#intro .slide .nav .btn{
  background: transparent !important;
  box-shadow: none !important;
  border: 1px solid transparent; /* no edge */
  color: var(--ink2);
}
#intro .slide .nav .btn:hover{
  filter: none !important;
  text-shadow: 0 0 8px rgba(213,168,74,.35);
}

/* Seam: no top fade; solid molten line from top to bottom */
.intro .pane::before{
  content:""; position:absolute; top:0; bottom:0; left:50%; width:3px;
  background: linear-gradient(to bottom, rgba(213,168,74,.85), rgba(213,168,74,.85)); /* solid */
  box-shadow:
    0 0 10px rgba(213,168,74,.5),
    0 0 22px rgba(213,168,74,.35);
  transform: translateX(-50%);
}
/* Left half: image + torn veil that reveals the art */
#intro .pic{ position: relative; overflow: hidden; }
#intro .pic .img{
  position:absolute; inset:0; z-index:1;
  background:
    /* TEMP: unmistakable placeholder to prove hole is cutting correctly */
    linear-gradient(135deg, #3c5570, #0b1117);
  background-size: cover; background-position: center;
  filter: contrast(1.06) saturate(1.08) brightness(1.02);
  transform: scale(1.02);
}

/* Foreground veil colored like the intro background.
   A CSS mask cuts a jagged “ripped paper” opening that reveals the image. */
#intro .pic .veil{
  position:absolute; inset:0; background:#0a0f14; z-index:2;
  -webkit-mask: url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" viewBox=\"0 0 1200 800\" preserveAspectRatio=\"none\">\
  <defs>\
    <!-- White shows veil; black becomes the hole revealing the image -->\
    <mask id=\"cut\">\
      <rect width=\"1200\" height=\"800\" fill=\"white\"/>\
      <!-- Jagged rectangle: top-right ~ aligned under masthead, bottom-left inset 15px -->\
      <path d=\"M60,740 L60,60 \
               L520,60 L560,100 L600,80 L640,120 L680,95 L720,130 L760,110 L800,140 L840,125 L880,155 L920,140 L960,170 L1000,160 L1040,190 L1080,185 L1120,210 L1120,740 Z\" \
            fill=\"black\"/>\
    </mask>\
  </defs>\
  <rect width=\"1200\" height=\"800\" fill=\"white\" mask=\"url(#cut)\"/>\
</svg>') center/100% 100% no-repeat;
  mask: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1200 800\" preserveAspectRatio=\"none\"><defs><mask id=\"cut\"><rect width=\"1200\" height=\"800\" fill=\"white\"/><path d=\"M60,740 L60,60 L520,60 L560,100 L600,80 L640,120 L680,95 L720,130 L760,110 L800,140 L840,125 L880,155 L920,140 L960,170 L1000,160 L1040,190 L1080,185 L1120,210 L1120,740 Z\" fill=\"black\"/></mask></defs><rect width=\"1200\" height=\"800\" fill=\"white\" mask=\"url(#cut)\"/></svg>') center/100% 100% no-repeat;
  opacity:.98;
  pointer-events:none;
}

.gloss:hover .tip{opacity:1}
/* auto shift when near edges; JS adjusts left dynamically */

/* Scrollbars */
.story-scroll::-webkit-scrollbar{width:10px}
.story-scroll::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#4b3917,#2b2212);border:2px solid #2b2212;border-radius:6px}
.story-scroll::-webkit-scrollbar-track{background:#0f1419}

/* Number inputs accent */
input[type="number"]{accent-color:var(--gold)}

/* Intro overlay must sit above the app and receive clicks */
#intro.intro{
  position: fixed; inset: 0; z-index: 9999;
  display: block; pointer-events: auto;
  background: #0a0f14; /* subtle veil */
}

/* Each slide stacks its nav above any art */
#intro .slide{ position: relative; }
#intro .slide .nav{
  position: absolute; right: 18px; bottom: 18px;
  z-index: 3;
}

/* Decorative layers never eat clicks */
#intro .slide .img,
#intro .slide .mist{ pointer-events: none; }

/* Make the copy area non-scrolling (no scrollbar) but roomy */
#intro .copy .scroll{
  overflow: visible;          /* no scrollbar */
  max-width: 64ch;            /* slightly wider column */
  padding: 12px 18px;
  text-align: justify;        /* true justification */
  text-justify: inter-word;   /* browser hint */
  margin-left: calc(50vw + 28px); /* sit cleanly to the right of the seam */
  margin-right: 8vw;               /* equidistant feel vs right edge */
}

/* Intro: remove chevron bullet + reset left padding created by ::before */
.intro.two-pane .slide .copy .scroll p::before { content: none !important; }
.intro.two-pane .slide .copy .scroll p { padding-left: 0 !important; }
.intro .para-chevron { display: none !important; } /* defensive, if a node exists */
/* === Intro slideshow: visibility toggle (place AFTER the .slide layout rule) === */
#intro .slide { 
  /* keep all slide panels hidden by default */
  display: none;
}

#intro .slide.active {
  /* match your slide layout: use grid if the slides are a two-column panel,
     otherwise use flex or block to match your CSS */
  display: block;   /* or: display:flex; or display:block; */
}
/* Edge-aware glossary tooltip */
.gloss { position: relative; font-weight: 800; color: var(--gold); text-shadow: 0 0 8px rgba(213,168,74,.3); cursor: help; }
.gloss:hover { color: var(--bronze); }
.gloss::after { content:'' !important; }

.gloss-tip {
  position: fixed;
  z-index: 9999;
  max-width: min(28rem, calc(100vw - 32px));
  pointer-events: none;
  background: rgba(14,14,18,.96);
  color: var(--ink);
  border: 1px solid rgba(255,184,84,.45);
  outline: 1px solid rgba(255,184,84,.18);
  padding: 10px 12px;
  line-height: 1.25;
  border-radius: 6px;
  box-shadow: 0 10px 24px rgba(0,0,0,.45), inset 0 0 18px rgba(255,184,84,.06);
  filter: drop-shadow(0 0 4px rgba(255,184,84,.25));
  opacity: 0;
  visibility: hidden;
  transform: none;
  transition: opacity .15s ease, visibility .15s ease;
}
.gloss-tip.on {
  opacity: 1;
  visibility: visible;
  transform: translate3d(var(--gx,0), var(--gy,0), 0) scale(1);
}

/* Kill any legacy ? decorations layered by pseudo-elements */
.gloss::after,
.rollglyph::after,
.roll-help::after { content:'' !important; }

/* Ensure the app underneath never steals focus while intro is open */
#intro:not(.hidden) ~ .app{ pointer-events: none; }

/* Intro solid backgrounds for contrast */
.intro .pane{ background:#0a0f14; }
.intro .txt{ background:#0d1218; }
#intro .gloss::after { content: '' !important; }

/* Stronger kill-switch for the legacy "?" marker on gloss terms */
.intro .copy .scroll .gloss::after,
.story-scroll .gloss::after { content: '' !important; }


/* Story brightness pulse */
.glow-story{ color:var(--ink2); animation:storyGlow 5.5s ease-in-out 1; }
@keyframes storyGlow{ 0%{ filter:brightness(1) } 50%{ filter:brightness(1.25) } 100%{ filter:brightness(1) } }

/* Chevron glow */
.frame::after{ filter: drop-shadow(0 0 6px rgba(213,168,74,.18)); }
.frame:hover::after{ filter: drop-shadow(0 0 10px rgba(213,168,74,.38)); }

/* Double-outline frame with reliable corners + chevrons */
.frame{ position:relative; }
.frame::before, .frame::after{ content:""; position:absolute; inset:0; pointer-events:none; }
.frame::before{ border:2px solid var(--line); }
.frame::after{ inset: -3px; border:2px solid var(--line2); }

/* Chevron detailing at corners */
.frame{ --chev: 14px; }
.frame > .chev{ position:absolute; width:var(--chev); height:var(--chev); pointer-events:none; opacity:.9; }
.frame > .chev.tl{ left:6px; top:6px; transform: rotate(45deg); }
.frame > .chev.tr{ right:6px; top:6px; transform: rotate(135deg); }
.frame > .chev.bl{ left:6px; bottom:6px; transform: rotate(-45deg); }
.frame > .chev.br{ right:6px; bottom:6px; transform: rotate(-135deg); }
.frame > .chev::before{ content:""; position:absolute; inset:0;
  background: linear-gradient(90deg, var(--gold) 0 40%, transparent 40% 60%, var(--gold2) 60%);
  box-shadow: 0 0 6px rgba(213,168,74,.35);
  opacity:.85;
}

/* JS embers layer (no CSS animations) */
#fx, #fxIntro { position: fixed; inset: 0; pointer-events: none; z-index: 1; }

.ember{
  position: fixed; left: 0; top: 0;
  width: 6px; height: 6px; border-radius: 50%;
  background: radial-gradient(circle at 50% 50%, rgba(255,190,120,.92), rgba(255,190,120,0) 66%);
  filter: brightness(1.2);
  will-change: transform, opacity;
}

/* Cinematic letterbox */
#letterbox{ position:fixed; inset:0; pointer-events:none; z-index:9990; }
#letterbox .bar{ position:absolute; left:0; right:0; height:9vh; background:rgba(0,0,0,.5);
  transform:translateY(0); transition: transform .35s ease; }
#letterbox.hidden .bar{ transform: translateY(-100%); }
#letterbox.hidden .bar.bottom{ transform: translateY(100%); }
#letterbox .bar.top{ top:0 } #letterbox .bar.bottom{ bottom:0 }

/* Pacing chips */
.pacing{ display:flex; justify-content:center; gap:8px; margin-top:8px }
.pacing .chip{ padding:4px 8px; border:1px solid var(--gold2); background:#0b1117; border-radius:999px; font-size:.9rem; opacity:.75 }
.pacing .chip.on{ opacity:1; box-shadow:0 0 0 1px var(--gold) inset }

/* Seals ring */
#sealsRing{ width:72px; height:72px; display:inline-block; }
#sealsRing circle.bg{ fill:none; stroke:#2b2212; stroke-width:6; }
#sealsRing circle.arc{ fill:none; stroke:var(--gold); stroke-width:6; stroke-linecap:round; stroke-dasharray: 0 999; transition: stroke-dasharray .4s ease; filter: drop-shadow(0 0 6px rgba(213,168,74,.35)); }

/* Focus outlines */
:focus-visible{ outline:2px dashed var(--gold); outline-offset:3px; }

/* High-contrast */
body.hc{ --ink:#f8f1cf; --ink2:#fff7d9; --gold:#edc062; --gold2:#b07a2c; --crimson:#a23b3b; --bg:#070a0e; --bg2:#0e141b; }
body.hc .frame::before{ border-color: #e7c57a; }
body.hc .frame::after{ border-color: #6d5120; }

/* Gloss highlight finder */
body.show-gloss .gloss{ text-decoration: underline wavy var(--gold); animation: glossPulse 1.8s ease-in-out infinite; }
@keyframes glossPulse{ 0%,100%{ text-underline-offset:2px } 50%{ text-underline-offset:6px } }

/* Now Playing widget */
.nowplay{ position:fixed; left:50%; transform:translateX(-50%); bottom:10px; width:min(920px, 96vw);
  background: linear-gradient(180deg,#0f1419,#0a0f14); border:2px solid var(--line); box-shadow:0 0 0 2px var(--line2) inset;
  padding:8px 12px; z-index: 8888; }
.nowplay .np-inner{ display:flex; align-items:center; gap:10px; }
.nowplay .np-dot{ width:8px; height:8px; border-radius:50%; background:var(--gold); box-shadow:0 0 10px rgba(213,168,74,.6); }
.nowplay .np-label{ color: var(--muted); font-weight:600; letter-spacing:.3px }
.nowplay #npTitle{ color: var(--ink2); font-weight:700 }
.nowplay .btn.mini{ padding:6px 10px; font-size:.9rem }


/* --- Intro two-pane layout & molten seam --- */
.intro { position: fixed; inset: 0; z-index: 9995; }
.intro .slide { position: relative; height: 100vh; display: grid; grid-template-columns: 1fr 1fr; }
.intro.two-pane .slide .img { grid-column: 1; }
.intro.two-pane .slide .copy{ grid-column: 2; display:flex; align-items:center; }
/* Force right-half, left-justified intro copy */
.intro.two-pane .slide .copy .scroll{
  text-align:left;
  margin: 0 6vw 0 0;     /* pull right */
  width:46vw; max-width:46vw;
  line-height:1.65;
}
.intro.two-pane .slide .copy .scroll p{
  position:relative; padding-left:28px;
}
.intro.two-pane .slide .copy .scroll p::before{
  content:""; position:absolute; left:10px; top:0.3em; width:10px; height:10px;
  border-left:2px solid rgba(213,168,74,0.9);
  border-bottom:2px solid rgba(213,168,74,0.9);
  transform:skew(-8deg) rotate(-45deg);
  filter:drop-shadow(0 0 4px rgba(213,168,74,.45));
}
.intro .slide .nav { position: absolute; right: 24px; bottom: 22px; z-index: 5; }

/* molten divider, fades near the top 20% to leave room for the logo */
.intro.two-pane .slide::before{
  content:""; position:absolute; top:0; bottom:0; left:50%; width:2px; transform:translateX(-50%); pointer-events:none;
  background: linear-gradient(to bottom,
    rgba(213,168,74,0) 0%,
    rgba(213,168,74,.75) 20%,
    rgba(213,168,74,.45) 60%,
    rgba(213,168,74,0) 100%);
  filter: drop-shadow(0 0 8px rgba(213,168,74,.45));
  animation: seamPulse 4.5s ease-in-out infinite;
}
@keyframes seamPulse{ 50%{ filter: drop-shadow(0 0 14px rgba(213,168,74,.62)); } }

/* overlay title at top center with underline (JS injects .intro-title) */
.intro-title{
  position:absolute; top:14px; left:50%; transform:translateX(-50%); z-index:7;
  font-family:"Cinzel",serif; font-weight:700; letter-spacing:1.2px;
  font-size:clamp(1.8rem,3.2vw,2.3rem); color:var(--ink2); text-transform:uppercase;
  text-shadow:0 0 22px rgba(213,168,74,.35),0 0 6px rgba(213,168,74,.55),0 0 1px rgba(255,200,120,.9);
  filter: drop-shadow(0 0 24px rgba(255,140,40,.25));
}

/* Ensure intro copy is right-justified */
.intro .copy .scroll{ text-align:right; margin-left:auto; margin-right:3vw; }

/* Intro layering: image+veil behind text/nav; title on top */
#intro { position: fixed; inset: 0; z-index: 9999; }
#intro .pane { position: relative; z-index: 1; }
#intro .pic { position: relative; z-index: 1; }
#intro .pic .img { position: absolute; inset: 0; z-index: 1; }
#intro .pic .veil { position: absolute; inset: 0; z-index: 2; }
#intro .txt { position: relative; z-index: 3; }
#intro .slide .nav { position: absolute; right: 18px; bottom: 18px; z-index: 4; }
.intro-title { z-index: 5; } /* your existing title */

