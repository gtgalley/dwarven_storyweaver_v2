:root{
  --bg:#0b0f13; --bg2:#121820; --ink:#e6d9a2;
  --gold:#d5a84a; --gold2:#9a6b24; --ink2:#c8bb87;
  --accent:#e0c98a; --desat:#c79d58; --crimson:#7e3a3a;
  --panel:#11161c; --line:#2a3038; --silver:#c9cbd1;
}

html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family: "Josefin Sans", system-ui, -apple-system, Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif;}

.app{min-height:100vh;display:grid;grid-template-rows:auto 1fr}
.masthead{padding:14px 12px 0}
.brand-title{font-family:"Cinzel",serif;text-align:center;letter-spacing:1px;font-weight:700;color:var(--gold);margin:0 0 10px 0;font-size:1.6rem;text-shadow:0 0 12px rgba(213,168,74,.18)}
.toolbar{display:flex;justify-content:center}
.cardish{background:linear-gradient(180deg,var(--bg2), #0b0f13);border:1px solid var(--gold2);border-radius:10px;box-shadow:0 0 0 2px rgba(154,107,36,.18) inset;padding:8px 12px}

.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:center}
.tag{margin-left:8px;border:1px solid var(--gold2);border-radius:999px;padding:2px 8px;font-size:.85rem;color:var(--gold)}

.btn{background:linear-gradient(180deg,#212833,#131921);color:var(--ink);border:1px solid var(--gold2);padding:8px 12px;border-radius:8px;cursor:pointer;transition:transform .05s ease, filter .15s ease, box-shadow .2s}
.btn:hover{filter:brightness(1.05)}
.btn:active{transform:scale(0.98)}
.btn.pulse{box-shadow:0 0 0 2px rgba(213,168,74,.25) inset}
.btn-act{background:linear-gradient(180deg,#3c3f44,#1c1f24);color:var(--gold);border-color:var(--silver)}
.btn-continue{background:linear-gradient(180deg,#262d38,#141921);}

.main{display:grid;grid-template-columns: 1fr 360px;gap:14px;padding:12px}
@media (max-width: 1100px){.main{grid-template-columns:1fr;grid-template-rows:auto auto;gap:10px}}

.story-scroll{background:#0e141a;border:1px solid var(--line);border-radius:10px;min-height:50vh;max-height:68vh;padding:18px;overflow:auto;box-shadow:0 0 40px rgba(213,168,74,.06) inset}
.story-scroll p{margin:.65rem 0 1rem 0;line-height:1.62}
.story-scroll em{opacity:.9}

.choices{margin-top:8px}
.choice-btn{display:block;width:100%;text-align:left;margin:6px 0;padding:12px 12px;background:linear-gradient(180deg,#141a21,#0d1218);border:1px solid var(--gold2);border-radius:8px;cursor:pointer;color:var(--desat)}
.choice-btn:hover{filter:brightness(1.07)}
.free{margin-top:8px;display:flex;gap:8px}
.free input{flex:1;background:#0d141a;border:1px solid var(--gold2);border-radius:8px;padding:10px 12px;color:var(--ink)}

.side .panel{padding:12px 12px 8px 12px}
.panel h3{font-weight:700;letter-spacing:.5px;color:var(--accent);margin:0 0 8px 0}
.panel div{color:var(--ink2)}

.shade{position:fixed;inset:0;background:#0007;z-index:9998;}
.shade.hidden{ display:none !important; }
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;}
.modal.hidden{display:none !important;}
.modal .inner{width:min(820px,92vw);background:#0f151b;border:1px solid var(--gold2);border-radius:12px;box-shadow:0 20px 80px rgba(0,0,0,.55)}
.modal .inner header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--gold2);color:var(--accent);font-weight:700}
.modal .inner .content{padding:16px}
.settings-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
.settings-grid h4{margin:.2rem 0 .5rem 0;color:var(--gold)}
.closeX{cursor:pointer;border:1px solid var(--gold2);padding:4px 8px;border-radius:6px}

.rollglyph{opacity:.7;margin-left:4px;cursor:help}

.beat-good{animation: beatGlowGold 2.2s ease 1}
.beat-bad{animation: beatGlowRed 2.2s ease 1}
@keyframes beatGlowGold{
  0%{color:var(--ink); text-shadow:0 0 0 rgba(213,168,74,0)}
  12%{color:#f1e3b5; text-shadow:0 0 14px rgba(213,168,74,.55)}
  100%{color:var(--ink); text-shadow:0 0 0 rgba(213,168,74,0)}
}
@keyframes beatGlowRed{
  0%{color:var(--ink); text-shadow:0 0 0 rgba(160,60,60,0)}
  12%{color:#ffd1d1; text-shadow:0 0 12px rgba(160,60,60,.55)}
  100%{color:var(--ink); text-shadow:0 0 0 rgba(160,60,60,0)}
}

/* smoke cursor for typewriter */
.smoke-cursor{
  display:inline-block; width:12px; height:12px; margin-left:6px; border-radius:50%;
  background: radial-gradient(closest-side, rgba(213,168,74,.35), rgba(213,168,74,0));
  filter: blur(1.2px); animation: puff 1.2s ease infinite;
}
.cursor-hidden{display:none}
@keyframes puff{
  0%{ transform:translateY(0) scale(1); opacity:.85 }
  60%{ transform:translateY(-6px) scale(1.25); opacity:.35 }
  100%{ transform:translateY(-10px) scale(1.4); opacity:0 }
}
